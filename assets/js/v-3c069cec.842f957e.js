"use strict";(self.webpackChunkgithub_io_document=self.webpackChunkgithub_io_document||[]).push([[805],{5427:(a,n,s)=>{s.r(n),s.d(n,{data:()=>e});const e={key:"v-3c069cec",path:"/notes/006-install-php7.html",title:"Install php7 (centos example)",lang:"zh-CN",frontmatter:{title:"Install php7 (centos example)"},excerpt:"",headers:[{level:2,title:"install dependencies",slug:"install-dependencies",children:[]}],filePathRelative:"notes/006-install-php7.md",git:{updatedTime:1680856038e3,contributors:[{name:"CaoJiayuan",email:"cjy632258@hotmail.com",commits:1}]}}},7858:(a,n,s)=>{s.r(n),s.d(n,{default:()=>p});const e=(0,s(6252).uE)('<h2 id="install-dependencies" tabindex="-1"><a class="header-anchor" href="#install-dependencies" aria-hidden="true">#</a> install dependencies</h2><blockquote><p>Build tools</p></blockquote><div class="language-hash ext-hash line-numbers-mode"><pre class="language-hash"><code>\nyum install -y gcc g++ cmake glibc-headers gcc-c++\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>Ext dependencies</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\nyum <span class="token function">install</span> -y libxml2-devel libcurl-devel libjpeg-devel libpng-devel libmcrypt-devel freetype-devel libicu-devel libxslt-devel\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>Configure (example)</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./configure --prefix<span class="token operator">=</span>/usr/local/php --with-config-file-path<span class="token operator">=</span>/usr/local/php/etc --with-config-file-scan-dir<span class="token operator">=</span>/usr/local/php/conf.d --with-apxs2<span class="token operator">=</span>/usr/local/apache/bin/apxs --with-mysqli<span class="token operator">=</span>mysqlnd --with-pdo-mysql<span class="token operator">=</span>mysqlnd --with-iconv-dir --with-freetype-dir<span class="token operator">=</span>/usr/local/freetype --with-jpeg-dir --with-png-dir --with-zlib --with-libxml-dir<span class="token operator">=</span>/usr --enable-xml --disable-rpath --enable-bcmath --enable-shmop --enable-sysvsem --enable-inline-optimization --with-curl<span class="token operator">=</span>/usr/local/curl --enable-mbregex --enable-mbstring --enable-intl --enable-pcntl --enable-ftp --with-gd --with-openssl --with-mhash --enable-pcntl --enable-sockets --with-xmlrpc --enable-zip --enable-soap --with-gettext --enable-opcache --with-xsl\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><blockquote><p>Then</p></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>\n<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>Example fpm conf</p></blockquote><p><code>/usr/local/php/etc/php-fpm.conf</code></p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code>\n<span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">global</span><span class="token punctuation">]</span></span>\n<span class="token key attr-name">pid</span> <span class="token punctuation">=</span> <span class="token value attr-value">/usr/local/php/var/run/php-fpm.pid</span>\n<span class="token key attr-name">error_log</span> <span class="token punctuation">=</span> <span class="token value attr-value">/usr/local/php/var/log/php-fpm.log</span>\n<span class="token key attr-name">log_level</span> <span class="token punctuation">=</span> <span class="token value attr-value">notice</span>\n<span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">www</span><span class="token punctuation">]</span></span>\n<span class="token key attr-name">listen</span> <span class="token punctuation">=</span> <span class="token value attr-value">/tmp/php-cgi.sock</span>\n<span class="token key attr-name">listen.backlog</span> <span class="token punctuation">=</span> <span class="token value attr-value">-1</span>\n<span class="token key attr-name">listen.allowed_clients</span> <span class="token punctuation">=</span> <span class="token value attr-value">127.0.0.1</span>\n<span class="token key attr-name">listen.owner</span> <span class="token punctuation">=</span> <span class="token value attr-value">www</span>\n<span class="token key attr-name">listen.group</span> <span class="token punctuation">=</span> <span class="token value attr-value">www</span>\n<span class="token key attr-name">listen.mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">0666</span>\n<span class="token key attr-name">user</span> <span class="token punctuation">=</span> <span class="token value attr-value">www</span>\n<span class="token key attr-name">group</span> <span class="token punctuation">=</span> <span class="token value attr-value">www</span>\n<span class="token key attr-name">pm</span> <span class="token punctuation">=</span> <span class="token value attr-value">dynamic</span>\n<span class="token key attr-name">pm.max_children</span> <span class="token punctuation">=</span> <span class="token value attr-value">10</span>\n<span class="token key attr-name">pm.start_servers</span> <span class="token punctuation">=</span> <span class="token value attr-value">2</span>\n<span class="token key attr-name">pm.min_spare_servers</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>\n<span class="token key attr-name">pm.max_spare_servers</span> <span class="token punctuation">=</span> <span class="token value attr-value">6</span>\n<span class="token key attr-name">pm.max_requests</span> <span class="token punctuation">=</span> <span class="token value attr-value">1024</span>\n<span class="token key attr-name">pm.process_idle_timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">10s</span>\n<span class="token key attr-name">request_terminate_timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>\n<span class="token key attr-name">request_slowlog_timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">0</span>\n<span class="token key attr-name">slowlog</span> <span class="token punctuation">=</span> <span class="token value attr-value">var/log/slow.log</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>Start up</p></blockquote><ul><li><code>cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</code></li><li><code>chmod +x /etc/init.d/php-fpm</code></li></ul>',14),p={render:function(a,n){return e}}}}]);